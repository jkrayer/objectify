<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Test Objectify</title>
  <link rel="stylesheet" href="../node_modules/mocha/mocha.css">
</head>
<body>

<form id="form-one" novalidate style="display:none;">
  <input type="hidden" name="hiddenField" value="Hidden Field Value">
  <input type="text" name="name" value="John Doe" placeholder="Name" />
  <input type="text" name="readOnly" value="Read Only" readonly />
  <input type="text" name="disabled" value="Disabled Field" disabled="true" />
  <input type="tel" name="tel" value="2125551212" placeholder="2125551212" />
  <input type="color" name="color" value="#0085bf" />
  <input type="date" name="date" value="1974-03-16" />
  <input type="datetime" name="datetime" value="1974-03-16T22:00:00" />
  <input type="datetime-local" name="datetime-local" value="1974-03-16T22:00:00" />
  <input type="email" name="email" value="jdoe@gmail.com" />
  <input type="month" name="month" value="2016-02" />
  <input type="week" name="week" value="2016-W27" />
  <input type="number" name="number" value="5" />
  <input type="range" name="range" value="500" min="1" max="1000" step="1" />
  <input type="search" name="search" value="Search Input" />
  <input type="time" name="time" value="01:59:27" />
  <input type="url" name="url" value="http://www.example.com" />
  <input type="submit" name="submitInput" value="Input Submit" />
  <input type="reset" name="resetInput" value="Input Reset" />
  <input type="button" name="buttonInput" value="Input Button" />
  <input type="image" name="imageInput" value="Input Image" src="/assets/img/noimage.png" />
  <fieldset>
    <legend>Select all that apply?</legend>
    <input type="checkbox" name="bands" value="Metallica" checked />
    <input type="checkbox" name="bands" value="Megadeth" checked />
    <input type="checkbox" name="bands" value="Slayer" checked />
    <input type="checkbox" name="bands" value="Creed" />
  </fieldset>
  <fieldset>
    <legend>Select one that appies?</legend>
    <input type="radio" name="genre" value="Metal" checked />
    <input type="radio" name="genre" value="Pop" />
    <input type="radio" name="genre" value="Country" />
  </fieldset>
  <select name="headphones">
    <option value="Beats">Beats</option>
    <option value="Motorheadphones" selected="">Mot&#246;rheadphones</option>
    <option value="Skull Candy">Skull Candy</option>
  </select>
  <select multiple name="player">
    <option value="Computer" selected="">Computer</option>
    <option value="Portable" selected="">Portable</option>
    <option value="Stereo">Stereo</option>
  </select>
  <textarea name="lyrics" rows="8" cols="40">Nobody gives a damn about anybody else,
Think everyone should feel the way they fell themselves,
Rich men think that happiness is a million dollar bills,
So how come most of them O. D. on sleeping pills...</textarea>
</form>

<div id="mocha"></div>

  <script src="../src/objectify.js"></script>
  <script src="../node_modules/mocha/mocha.js"></script>
  <script src="../node_modules/chai/chai.js"></script>
  <script>
      mocha.ui('bdd');
      mocha.reporter('html');
      var assert = chai.assert;
      var form = document.getElementsByTagName('form')[0];

      describe('Objectify', () => {
        describe('Get Simple Form Data', function () {
          const actualResult = objectify(form);
          var expectedResult = {
            hiddenField: 'Hidden Field Value',
            name: 'John Doe',
            readOnly: 'Read Only',
            disabled: 'Disabled Field',
            tel: '2125551212',
            color: '#0085bf',
            date: '1974-03-16',
            datetime: '1974-03-16T22:00:00',
            'datetime-local': '1974-03-16T22:00:00',
            email: 'jdoe@gmail.com',
            month: '2016-02',
            week: '2016-W27',
            number: '5',
            range: '500',
            search: 'Search Input',
            time: '01:59:27',
            url: 'http://www.example.com',
            bands: ['Metallica', 'Megadeth', 'Slayer'],
            genre: 'Metal',
            headphones: 'Motorheadphones',
            player: ['Computer', 'Portable'],
            lyrics: 'Nobody gives a damn about anybody else,\nThink everyone should feel the way they fell themselves,\nRich men think that happiness is a million dollar bills,\nSo how come most of them O. D. on sleeping pills...'
          };

          it('should return an object', function () {
            assert.isObject(actualResult);
          });
          it('should contain the expected form data', () => {
            assert.deepEqual(actualResult, expectedResult);
          });
        });

        describe('Get Form Data minus exclusions', function () {
          var actualResult = objectify(form, ['hiddenField', 'tel']);
          var expectedResult = {
            name: 'John Doe',
            readOnly: 'Read Only',
            disabled: 'Disabled Field',
            color: '#0085bf',
            date: '1974-03-16',
            datetime: '1974-03-16T22:00:00',
            'datetime-local': '1974-03-16T22:00:00',
            email: 'jdoe@gmail.com',
            month: '2016-02',
            week: '2016-W27',
            number: '5',
            range: '500',
            search: 'Search Input',
            time: '01:59:27',
            url: 'http://www.example.com',
            bands: ['Metallica', 'Megadeth', 'Slayer'],
            genre: 'Metal',
            headphones: 'Motorheadphones',
            player: ['Computer', 'Portable'],
            lyrics: 'Nobody gives a damn about anybody else,\nThink everyone should feel the way they fell themselves,\nRich men think that happiness is a million dollar bills,\nSo how come most of them O. D. on sleeping pills...'
          };

          it('should contain the expected form data', () => {
            assert.deepEqual(actualResult, expectedResult);
          });
        });

        describe('Get Sanitized Form Data', function () {
          var actualResult = objectify(form, ['hiddenField', 'tel'], {
            name: function(val) {
              return val.replace('Doe', 'Johnson');
            },
            color: function(val) {
              return val.replace('00', 'ff');
            }
          });
          var expectedResult = {
            name: 'John Johnson',
            readOnly: 'Read Only',
            disabled: 'Disabled Field',
            color: '#ff85bf',
            date: '1974-03-16',
            datetime: '1974-03-16T22:00:00',
            'datetime-local': '1974-03-16T22:00:00',
            email: 'jdoe@gmail.com',
            month: '2016-02',
            week: '2016-W27',
            number: '5',
            range: '500',
            search: 'Search Input',
            time: '01:59:27',
            url: 'http://www.example.com',
            bands: ['Metallica', 'Megadeth', 'Slayer'],
            genre: 'Metal',
            headphones: 'Motorheadphones',
            player: ['Computer', 'Portable'],
            lyrics: 'Nobody gives a damn about anybody else,\nThink everyone should feel the way they fell themselves,\nRich men think that happiness is a million dollar bills,\nSo how come most of them O. D. on sleeping pills...'
          };

          it('should contain the expected form data', () => {
            assert.deepEqual(actualResult, expectedResult);
          });
        });
      });

    mocha.run();
  </script>

</body>
</html>
